{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Notifica√ß√µes - Biblioteca Acad√™mica</title>
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap">
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=notifications,book,person" />
	<script src="https://kit.fontawesome.com/9ca5555edc.js" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="{% static 'usuario/css/responsive.css' %}">
	<link rel="stylesheet" href="{% static 'usuario/css/index.css' %}">
	<link rel="stylesheet" href="{% static 'usuario/aluno/css/styles-aluno.css' %}">
	<link rel="stylesheet" href="{% static 'livro/css/styles-emprestimos.css' %}">
	<style>
		.container-notificacoes {
			width: 100%;
			height: 80vh;
			display: grid;
			grid-template-columns: 1fr 3fr;
			padding: 30px;
			background-color: #f8f9fa;
			/* Alterado para combinar com o design geral */
		}
		.notificacoes {
			border: 1px solid #dee2e6;
			border-radius: 5px;
			padding: 15px;
			background-color: #ffffff;
			/* Fundo branco para contraste */
			max-height: 80vh;
			overflow-y: auto;
		}
		.notificacao {
			border: 1px solid #dee2e6;
			/* Adicionado para melhor defini√ß√£o */
			border-radius: 5px;
			padding: 15px;
			margin-bottom: 20px;
			background-color: #ffffff;
			/* Fundo branco para contraste */
			display: flex;
			flex-direction: row;
			justify-content: space-between;
		}
		.notificacao:hover {
			background-color: #e9ecef;
			/* Efeito hover para melhor UX */
			border-color: #adb5bd;
			/* Destaca a borda ao passar o mouse */
			transition: background-color 0.3s, border-color 0.3s
		}
		.link-notificacao {
			text-decoration: none;
			color: inherit;
		}

		#detalhes {
			border: 1px solid #ccc;
			border-radius: 10px;
			padding: 20px;
			margin-left: 20px;
			display: flex;
			flex-direction: column;
			background-color: #ffffff;
			 /* Fundo branco para contraste */
			justify-content: space-between;
		}

		.titulo {
			border-bottom: 1px solid #ccc;
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: space-between;
			padding-bottom: 10px;
		}

		.titulo-notificacao {
			font-size: 1.5em;
			font-weight: bold;
			margin-bottom: 10px;
			color: #333;
		}

		.acoes {
			display: flex;
			flex-direction: row;
			justify-content: flex-end;
			gap: 15px;
			margin-top: 20px;
		}

		.acoes a {
			text-decoration: none;
			color: #007bff;
			font-weight: 500;
		}
		.ativa {
			background-color: #333;
			color: #fff;
		}
		.ativa:hover {
			background-color: #333;
			color: #fff;
		}
	</style>
</head>

<body>
	<!-- Header -->
	<header class="header-backdrop border-bottom">
		{% if user_context.aluno %}
		{% include 'usuario/aluno/parciais/_nav.html' %}
		{% elif user_context.professor %}
		{% include 'usuario/professor/parciais/_nav.html' %}
		{% elif user_context.funcionario %}
		{% include 'usuario/funcionario/parciais/_nav.html' %}
		{% endif %}
	</header>

	<main>
		{%if notificacoes %}
		<div class="container-notificacoes">
			<div class="notificacoes">
				{% for notificacao in notificacoes %}
				<a href="{% url  'notificacao:detalhe_notificacao' notificacao.id %}" class="link-notificacao">
					<div class="notificacao {% if notificacao.id == notificacao_detalhes.id %}ativa{%endif%}">
						<span>{{notificacao.title}}</span>
						{% if notificacao.is_read %}
						<span></span>
						{% elif not notificacao.is_read %}
							<span>üî¥</span>
						{% endif %}
					</div>
				</a>
				{% endfor %}
			</div>
			<div id="detalhes">
				{% if notificacao_detalhes %}
				<div class="titulo">
					<span class="titulo-notificacao">{{notificacao_detalhes.title}}</span>
					{% if notificacao_detalhes.is_read %}
					<span class="" style="color: green;">Lida</span>
					{% elif not notificacao_detalhes.is_read %}
					<span class="" style="color: red;">Nao Lida</span>
					{% endif %}
				</div>
				<div class="corpo">
					<p>{{notificacao_detalhes.message}}</p>
					<p>Recebida em: {{notificacao_detalhes.created_at}}</p>
				</div>
				<div class="acoes">
					<a class="btn btn-secondary" href="{% url 'notificacao:notificacoes' user.id %}" style="background-color: #6c757d; color: #fff; padding: 8px 18px; border-radius: 5px; border: none; transition: background 0.2s; font-weight: 500;">Voltar</a>
					<a class="btn btn-danger" href="{% url 'notificacao:deletar_notificacao' notificacao_detalhes.id %}" style="background-color: #dc3545; color: #fff; padding: 8px 18px; border-radius: 5px; border: none; transition: background 0.2s; font-weight: 500;">Excluir Notifica√ß√£o</a>
				</div>
				{% else %}
					<p>Selecione uma notifica√ß√£o para ver os detalhes.</p>
				{% endif %}
			</div>
		</div>
		{% else %}
		<p>Voc√™ n√£o tem notifica√ß√µes.</p>
		{% endif %}
	</main>
	<!-- Script da pagina - toggle menu -->
	<script>
		// Mobile menu toggle and stats calculation
		document.addEventListener('DOMContentLoaded', function () {
			// Calculate stats
			const loanCards = document.querySelectorAll('.loan-card');
			let ativos = 0;
			let devolvidos = 0;

			loanCards.forEach(card => {
				const status = card.querySelector('.loan-status');
				if (status && status.classList.contains('active')) {
					ativos++;
				} else if (status && status.classList.contains('inactive')) {
					devolvidos++;
				}
			});

			const ativosCount = document.getElementById('ativos-count');
			const devolvidosCount = document.getElementById('devolvidos-count');

			if (ativosCount) ativosCount.textContent = ativos;
			if (devolvidosCount) devolvidosCount.textContent = devolvidos;

			// Mobile menu
			const mobileMenuBtn = document.getElementById('mobile-menu-btn');
			const navbarCollapse = document.getElementById('navbarNav');
			const userMenuBtn = document.getElementById('user-menu-btn');
			const userDropdown = document.getElementById('user-dropdown');

			if (mobileMenuBtn && navbarCollapse) {
				mobileMenuBtn.addEventListener('click', function () {
					navbarCollapse.classList.toggle('show');
					this.classList.toggle('active');
				});
			}

			if (userMenuBtn && userDropdown) {
				userMenuBtn.addEventListener('click', function (e) {
					e.stopPropagation();
					userDropdown.classList.toggle('show');
				});

				document.addEventListener('click', function () {
					userDropdown.classList.remove('show');
				});

				userDropdown.addEventListener('click', function (e) {
					e.stopPropagation();
				});
			}
		});
	</script>
</body>

</html>