{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    {% include 'usuario/funcionario/parciais/_head.html' %}
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap">
    <script src="https://kit.fontawesome.com/9ca5555edc.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{% static 'usuario/css/index.css' %}">
    <link rel="stylesheet" href="{% static 'usuario/css/responsive.css' %}">
    <link rel="stylesheet" href="{% static 'usuario/aluno/css/styles-aluno.css' %}">
    <link rel="stylesheet" href="{% static 'usuario/aluno/css/dashboard-aluno.css' %}">
</head>

<body>
    <header>
        {% include 'usuario/funcionario/parciais/_nav.html' %}
    </header>
    {% for message in messages %}
    {% endfor %}
    <main class="dashboard-main">
        <div class="container-fluid">
            <!-- Welcome Section -->
            <section class="welcome-section">
                <div class="welcome-content">
                    <h1 class="font-display welcome-title">
                        Ol√°, {{ user.first_name|default:"Funcion√°rio" }}! üë®‚Äçüíº
                    </h1>
                    <p class="welcome-subtitle">
                        Bem-vindo ao seu painel de trabalho. Gerencie opera√ß√µes da biblioteca e seus pr√≥prios empr√©stimos.
                    </p>
                </div>
                <div class="quick-actions">
                    <a href="{% url 'livro:listar_livros' %}" class="btn btn-primary">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        Buscar Livros
                    </a>
                    <a href="#operacoes-funcionais" class="btn btn-outline-secondary">
                        <i class="fa-solid fa-users"></i>
                        Opera√ß√µes de Atendimento
                    </a>
                </div>
            </section>

            <!-- Stats Cards -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon stat-icon-primary">
                            <i class="fa-solid fa-book"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value">{{ funcionario.emprestimos|default:0 }}</h3>
                            {% if funcionario.emprestimos == 1 %}
                            <p class="stat-label">Meu Empr√©stimo Ativo</p>
                            {% else %}
                            <p class="stat-label">Meus Empr√©stimos Ativos</p>
                            {% endif %}
                            <a href="{% url 'livro:listar_emprestimos' %}" class="stat-link">
                                Ver meus empr√©stimos <i class="fa-solid fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon stat-icon-secondary">
                            <i class="fa-solid fa-bookmark"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value">{{ funcionario.reservas|default:0 }}</h3>
                            {% if funcionario.reservas == 1 %}
                            <p class="stat-label">Minha Reserva Pendente</p>
                            {% else %}
                            <p class="stat-label">Minhas Reservas Pendentes</p>
                            {% endif %}
                            <a href="{% url 'livro:listar_reservas' %}" class="stat-link">
                                Ver minhas reservas <i class="fa-solid fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon stat-icon-success">
                            <i class="fa-solid fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value">{{ total_emprestimos_realizados|default:0 }}</h3>
                            <p class="stat-label">Empr√©stimos Processados Hoje</p>
                            <a href="#" class="stat-link">
                                Ver estat√≠sticas <i class="fa-solid fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon stat-icon-info">
                            <i class="fa-solid fa-briefcase"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-value">{{ user.funcionario.cargo|default:"Funcion√°rio" }}</h3>
                            <p class="stat-label">Cargo</p>
                            <a href="{% url 'usuario:ler-funcionario' uid=user.id %}" class="stat-link">
                                Ver perfil <i class="fa-solid fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Main Content Grid -->
            <section class="content-section">
                <div class="content-grid" style="grid-template-columns: 1fr;">
                    
                    <!-- Se√ß√£o 1: Opera√ß√µes do Pr√≥prio Funcion√°rio -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-header-content">
                                <h2 class="font-display card-title">
                                    <i class="fa-solid fa-user-circle"></i>
                                    Minhas Opera√ß√µes Pessoais
                                </h2>
                                <p class="card-subtitle">Gerencie seus pr√≥prios empr√©stimos e reservas</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="quick-links-grid">
                                <a href="{% url 'livro:listar_livros' %}" class="quick-link-item">
                                    <div class="quick-link-icon">
                                        <i class="fa-solid fa-search"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Buscar Livros para Mim</h4>
                                        <p>Explore o acervo e fa√ßa empr√©stimos pessoais</p>
                                    </div>
                                </a>

                                <a href="{% url 'livro:listar_emprestimos' %}" class="quick-link-item">
                                    <div class="quick-link-icon">
                                        <i class="fa-solid fa-book-open"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Meus Empr√©stimos</h4>
                                        <p>Ver meus livros emprestados</p>
                                    </div>
                                </a>

                                <a href="{% url 'livro:listar_reservas' %}" class="quick-link-item">
                                    <div class="quick-link-icon">
                                        <i class="fa-solid fa-bookmark"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Minhas Reservas</h4>
                                        <p>Gerenciar minhas reservas de livros</p>
                                    </div>
                                </a>

                                <a href="{% url 'usuario:ler-funcionario' uid=user.id %}" class="quick-link-item">
                                    <div class="quick-link-icon">
                                        <i class="fa-solid fa-user"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Meu Perfil</h4>
                                        <p>Ver e editar meus dados</p>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Se√ß√£o 2: Opera√ß√µes para Outros Usu√°rios -->
                    <div class="dashboard-card" id="operacoes-funcionais">
                        <div class="card-header">
                            <div class="card-header-content">
                                <h2 class="font-display card-title">
                                    <i class="fa-solid fa-users-gear"></i>
                                    Opera√ß√µes de Atendimento ao P√∫blico
                                </h2>
                                <p class="card-subtitle">Gerencie empr√©stimos, devolu√ß√µes e reservas de usu√°rios</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="quick-links-grid">
                                <!-- Emprestar Livro para Usu√°rio -->
                                <a href="{% url 'livro:emprestar_livro' %}" class="quick-link-item">
                                    <div class="quick-link-icon" style="background-color: #4CAF50;">
                                        <i class="fa-solid fa-hand-holding-hand"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Emprestar Livro</h4>
                                        <p>Registrar empr√©stimo para um usu√°rio</p>
                                    </div>
                                </a>

                                <!-- Devolver Livro -->
                                <a href="{% url 'livro:registrar_devolucao' %}" class="quick-link-item">
                                    <div class="quick-link-icon" style="background-color: #2196F3;">
                                        <i class="fa-solid fa-rotate-left"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Registrar Devolu√ß√£o</h4>
                                        <p>Processar devolu√ß√£o de livros</p>
                                    </div>
                                </a>

                                <!-- Consultar Reservas de Usu√°rios -->
                                <a href="{% url 'livro:listar_todas_reservas' %}" class="quick-link-item">
                                    <div class="quick-link-icon" style="background-color: #FF9800;">
                                        <i class="fa-solid fa-list-check"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Consultar Reservas</h4>
                                        <p>Ver todas as reservas pendentes</p>
                                    </div>
                                </a>

                                <!-- Buscar Usu√°rio -->
                                <a href="{% url 'usuario:buscar_usuario' %}" class="quick-link-item">
                                    <div class="quick-link-icon" style="background-color: #9C27B0;">
                                        <i class="fa-solid fa-magnifying-glass"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Buscar Usu√°rio</h4>
                                        <p>Consultar informa√ß√µes de usu√°rios</p>
                                    </div>
                                </a>

                                <!-- Renovar Empr√©stimo -->
                                <a href="{% url 'livro:renovar_emprestimo' %}" class="quick-link-item">
                                    <div class="quick-link-icon" style="background-color: #00BCD4;">
                                        <i class="fa-solid fa-arrows-rotate"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Renovar Empr√©stimo</h4>
                                        <p>Renovar prazo de empr√©stimo de usu√°rio</p>
                                    </div>
                                </a>

                                <!-- Cancelar Reserva -->
                                <a href="{% url 'livro:cancelar_reserva' %}" class="quick-link-item">
                                    <div class="quick-link-icon" style="background-color: #F44336;">
                                        <i class="fa-solid fa-ban"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Cancelar Reserva</h4>
                                        <p>Cancelar reserva de um usu√°rio</p>
                                    </div>
                                </a>

                                <!-- Hist√≥rico de Empr√©stimos -->
                                <a href="{% url 'livro:historico_emprestimos' %}" class="quick-link-item">
                                    <div class="quick-link-icon" style="background-color: #607D8B;">
                                        <i class="fa-solid fa-clock-rotate-left"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Hist√≥rico de Empr√©stimos</h4>
                                        <p>Ver hist√≥rico completo de opera√ß√µes</p>
                                    </div>
                                </a>

                                <!-- Relat√≥rios -->
                                <a href="#" class="quick-link-item" onclick="alert('Funcionalidade em desenvolvimento: Relat√≥rios'); return false;">
                                    <div class="quick-link-icon" style="background-color: #795548;">
                                        <i class="fa-solid fa-chart-line"></i>
                                    </div>
                                    <div class="quick-link-content">
                                        <h4>Relat√≥rios</h4>
                                        <p>Gerar relat√≥rios de atividades</p>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-header-content">
                                <h2 class="font-display card-title">
                                    <i class="fa-solid fa-clock-rotate-left"></i>
                                    Atividades Recentes
                                </h2>
                                <p class="card-subtitle">√öltimas opera√ß√µes realizadas</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="activity-list">
                                <div class="activity-item">
                                    <div class="activity-icon activity-icon-primary">
                                        <i class="fa-solid fa-info-circle"></i>
                                    </div>
                                    <div class="activity-content">
                                        <p class="activity-title">Nenhuma atividade recente</p>
                                        <p class="activity-time">Suas opera√ß√µes aparecer√£o aqui</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Information Banner -->
            <section class="info-banner">
                <div class="info-banner-content">
                    <div class="info-banner-icon">
                        <i class="fa-solid fa-info-circle"></i>
                    </div>
                    <div class="info-banner-text">
                        <h3>Lembrete Importante!</h3>
                        <p>Como funcion√°rio, voc√™ pode emprestar livros para si mesmo e tamb√©m processar empr√©stimos para outros usu√°rios. Sempre verifique os dados antes de confirmar qualquer opera√ß√£o.</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script>
    // Mobile menu toggle and user dropdown
    document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const navbarCollapse = document.getElementById('navbarNav');
        const userMenuBtn = document.getElementById('user-menu-btn');
        const userDropdown = document.getElementById('user-dropdown');

        if (mobileMenuBtn && navbarCollapse) {
            mobileMenuBtn.addEventListener('click', function() {
                navbarCollapse.classList.toggle('show');
                this.classList.toggle('active');
            });
        }

        if (userMenuBtn && userDropdown) {
            userMenuBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                userDropdown.classList.toggle('show');
            });

            document.addEventListener('click', function() {
                userDropdown.classList.remove('show');
            });

            userDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }
    });
    </script>
</body>

</html>